!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function t(e,t,n){return n&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,s=[],c=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(c=(i=a.call(n)).done)&&(s.push(i.value),s.length!==t);c=!0);}catch(u){d=!0,r=u}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw r}}return s}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}var d={CALL_LIMIT:10,TIME_THRESHOLD:18e5,SAVE_TIME_ON_PAGE_INTERVAL:1e4,MAX_TIME_ON_PAGE_ITEMS_IN_LOCAL_STORAGE:32,DOMAIN_FPH_KEY:"DotmetricsDomainFPH",TIME_STAMP_LIMIT_24_HOURS:864e5,TIME_STAMP_LIMIT_5_DAYS:432e6,NULL_COOKIE_VALUE:"00000000-0000-0000-0000-000000000000"},u={DATA_URL:"/SiteEvent.dotmetrics",PING_URL:"/Ping.dotmetrics",POST_URL:"/DeviceInfo.dotmetrics",AJAX_EVENT_URL:"/AjaxEvent.dotmetrics",BEACON_URL:"/BeaconEvent.dotmetrics",ERROR_EVENT_URL:"/ErrorEvent.dotmetrics",EDI_URL:"/edi",EDI_DAILY_URL:"/edi-daily",UIMUrl:"/urls-in-measurement",DOMAIN_SYNC_URL:"/sync"},l=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona","Bell MT","Berlin Sans FB","Corbel","Kalinga","Miriam Regular","Modern Standard","Segoe UI","Segoe Print","Inconsolata","Droid Sans Mono","Anonymous Pro","Liberation Mono","Terminus","Rosario","Roboto Slab","Oswald","Stalemate","Crimson Text","Gravitas One","Jura","League Gothic","Fjord","Proxima Nova","Trivia Grotesk","Pluto Sans","Museo Sans","Futura","Al Bayan","American Typewriter","Andale Mono","Apple Casual","Apple Chancery","Apple Garamond","Apple Gothic","Apple LiGothic","Apple LiSung","Apple Myungjo","Apple Symbols",".AquaKana","Arial Hebrew","Ayuthaya","Baghdad","Baskerville","Beijing","BiauKai","Big Caslon","Brush Script","Chalkboard","Chalkduster","Charcoal","Charcoal CY","Chicago","Cochin","Comic Sans","Cooper","Copperplate","Corsiva Hebrew","DecoType Naskh","Devanagari","Didot","Euphemia UCAS","Fang Song","Gadget","Geeza Pro","Geezah","Geneva","Geneva CY","Gill Sans","Gujarati","Gung Seoche","Gurmukhi","Hangangche","HeadlineA","Hei","Helvetica","Helvetica CY","Helvetica Neue","Herculanum","Hiragino Kaku Gothic Pro","Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Std","Hiragino Kaku Gothic StdN","Hiragino Maru Gothic Pro","Hiragino Maru Gothic ProN","Hiragino Mincho Pro","Hiragino Mincho ProN","Hoefler Text","Inai Mathi","Jung Gothic","Kai","Keyboard","Krungthep","KufiStandard GK","LastResort","LiHei Pro","LiSong Pro","Lucida Grande","Marker Felt","Menlo","Monaco","Monaco CY","Mshtakan","Nadeem","New Peninim","New York","NISC GB18030","Optima","Osaka","Palatino","PC Myungjo","Pilgiche","Plantagenet Cherokee","Raanana","Sand","Sathu","Seoul","Shin Myungjo Neue","Silom","Skia","Song","ST FangSong","ST Heiti","ST Kaiti","ST Song","Symbol","Tae Graphic","Taipei","Techno","Textile","Thonburi","Times CY","Zapf Chancery","Zapf Dingbats","Zapfino","Abadi MT Condensed Light","Aharoni","Aldhabi","Andalus","Angsana New","AngsanaUPC","Aparajita","Arabic Typesetting","Arial Nova","Batang","BatangChe","Book Antiqua","Browallia New","BrowalliaUPC","Calibri","Calibri Light","Calisto MT","Cambria","Cambria Math","Candara","Consolas","Constantia","Copperplate Gothic Bold","Copperplate Gothic Light","Cordia New","CordiaUPC","DaunPenh","David","Dengxian","DFKai-SB","DilleniaUPC","DokChampa","Dotum","DotumChe","Ebrima","Estrangelo Edessa","EucrosiaUPC","Euphemia","FangSong","Franklin Gothic Medium","FrankRuehl","FreesiaUPC","Gabriola","Gadugi","Gautami","Georgia Pro","Gill Sans Nova","Gisha","Gulim","GulimChe","Gungsuh","GungsuhChe","IrisUPC","Iskoola Pota","JasmineUPC","KaiTi","Kartika","Khmer UI","KodchiangUPC","Kokila","Lao UI","Latha","Leelawadee","Leelawadee UI","Levenim MT","LilyUPC","Lucida Handwriting Italic","Lucida Sans Unicode","Malgun Gothic","Mangal","Manny ITC","Marlett","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei UI","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft YaHei UI","Microsoft Yi Baiti","MingLiU, PMingLiU","MingLiU-ExtB, PMingLiU-ExtB","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","Miriam, Miriam Fixed","Mongolian Baiti","MoolBoran","MS Gothic, MS PGothic","MS Mincho, MS PMincho","MS UI Gothic","MV Boli","Myanmar Text","Narkisim","Neue Haas Grotesk Text Pro","News Gothic MT","Nirmala UI","NSimSun","Nyala","Palatino Linotype","Raavi","Rockwell Nova","Rod","Sakkal Majalla","Sanskrit Text","Segoe MDL2 Assets","Segoe Script","Segoe UI v5.00[3]","Segoe UI v5.01[4]","Segoe UI v5.27[5]","Segoe UI v5.35","Segoe UI Emoji","Segoe UI Historic[6]","Segoe UI Symbol","Shonar Bangla","Shruti","SimHei","SimKai","Simplified Arabic","SimSun","SimSun-ExtB","Sitka Banner","Sitka Display","Sitka Heading","Sitka Small","Sitka Subheading","Sitka Text","Sylfaen","Traditional Arabic","Tunga","Urdu Typesetting","Utsaah","Vani","Verdana Pro","Vijaya","Vrinda","Webdings","Westminster","Wingdings","Yu Gothic","Yu Gothic UI","Yu Mincho","Abyssinica SIL","Bitstream Charter","Century Schoolbook L","Courier 10 Pitch","DejaVu Sans","DejaVu Sans Condensed","DejaVu Sans Light","DejaVu Sans Mono","DejaVu Serif","DejaVu Serif Condensed","Dingbats","Droid Arabic Kufi","Droid Arabic Naskh","Droid Naskh Shift Alt","Droid Sans","Droid Sans Arabic","Droid Sans Armenian","Droid Sans Ethiopic","Droid Sans Fallback","Droid Sans Georgian","Droid Sans Hebrew","Droid Sans Japanese","Droid Serif","FreeMono","FreeSans","FreeSerif","Gargi","Garuda","KacstArt","KacstBook","KacstDecorative","KacstDigital","KacstFarsi","KacstLetter","KacstNaskh","KacstOffice","KacstOne","KacstPen","KacstPoster","KacstQurn","KacstScreen","KacstTitle","KacstTitleL","Kedage","Khmer OS","Khmer OS System","Kinnari","Laksaman","Liberation Sans","Liberation Sans Narrow","Liberation Serif","LKLUG","Lohit Bengali","Lohit Devanagari","Lohit Gujarati","Lohit Punjabi","Lohit Tamil","Loma","Mallige","Meera","mry_KacstQurn","Mukti Narrow","NanumBarunGothic","NanumGothic","NanumMyeongjo","Nimbus Mono L","Nimbus Roman No9 L","Nimbus Sans L","Norasi","OpenSymbol","Padauk","Padauk Book","Phetsarath OT","Pothana2000","Purisa","Rachana","Rekha","Saab","Sawasdee","STIX","STIXGeneral","TakaoPGothic","Tibetan Machine Uni","Tlwg Typist","Tlwg Typo","TlwgMono","TlwgTypewriter","Ubuntu","Ubuntu Condensed","Ubuntu Light","Ubuntu Mono","Umpush","URW Bookman L","URW Chancery L","URW Gothic L","URW Palladio L","utkal","Vemana2000","Waree","WenQuanYi Micro Hei","WenQuanYi Micro Hei Mono","Academy Engraved LET","Apple Color Emoji","AppleGothic","Bangla Sangam MN","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni Ornaments","Bradley Hand","Chalkboard SE","Devanagari Sangam MN","Gujarati Sangam MN","Gurmukhi MN","Heiti SC","Heiti TC","Kailasa","Kannada Sangam MN","Malayalam Sangam MN","Marion","Noteworthy","Oriya Sangam MN","Party LET","Sinhala Sangam MN","Snell Roundhand","Tamil Sangam MN","Telugu Sangam MN"],h=["sans-serif-thin","ARNO PRO","Agency FB","Arabic Typesetting","Arial Unicode MS","AvantGarde Bk BT","BankGothic Md BT","Batang","Bitstream Vera Sans Mono","Calibri","Century","Century Gothic","Clarendon","EUROSTILE","Franklin Gothic","Futura Bk BT","Futura Md BT","GOTHAM","Gill Sans","HELV","Haettenschweiler","Helvetica Neue","Humanst521 BT","Leelawadee","Letter Gothic","Levenim MT","Lucida Bright","Lucida Sans","Menlo","MS Mincho","MS Outlook","MS Reference Specialty","MS UI Gothic","MT Extra","MYRIAD PRO","Marlett","Meiryo UI","Microsoft Uighur","Minion Pro","Monotype Corsiva","PMingLiU","Pristina","SCRIPTINA","Segoe UI Light","Serifa","SimHei","Small Fonts","Staccato222 BT","TRAJAN PRO","Univers CE 55 Medium","Vrinda","ZWAdobeF","DotmetricsFont"],f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t(e,0,[{key:"encode",value:function(t){var n,i,r,a,o,s,c,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(t=e.utf8Encode(t);l<t.length;)a=(n=t.charCodeAt(l++))>>2,o=(3&n)<<4|(i=t.charCodeAt(l++))>>4,s=(15&i)<<2|(r=t.charCodeAt(l++))>>6,c=63&r,isNaN(i)?s=c=64:isNaN(r)&&(c=64),u=u+d.charAt(a)+d.charAt(o)+d.charAt(s)+d.charAt(c);return u}},{key:"utf8Encode",value:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t}},{key:"SHA1",value:function(e){function t(e,t){return e<<t|e>>>32-t}function n(e){var t,n="";for(t=7;t>=0;t--)n+=(e>>>4*t&15).toString(16);return n}var i,r,a,o,s,c,d,u,l,h=new Array(80),f=1732584193,m=4023233417,v=2562383102,g=271733878,p=3285377520,S=(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t}(e)).length,y=new Array;for(r=0;r<S-3;r+=4)a=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),y.push(a);switch(S%4){case 0:r=2147483648;break;case 1:r=e.charCodeAt(S-1)<<24|8388608;break;case 2:r=e.charCodeAt(S-2)<<24|e.charCodeAt(S-1)<<16|32768;break;case 3:r=e.charCodeAt(S-3)<<24|e.charCodeAt(S-2)<<16|e.charCodeAt(S-1)<<8|128}for(y.push(r);y.length%16!=14;)y.push(0);for(y.push(S>>>29),y.push(S<<3&4294967295),i=0;i<y.length;i+=16){for(r=0;r<16;r++)h[r]=y[i+r];for(r=16;r<=79;r++)h[r]=t(h[r-3]^h[r-8]^h[r-14]^h[r-16],1);for(o=f,s=m,c=v,d=g,u=p,r=0;r<=19;r++)l=t(o,5)+(s&c|~s&d)+u+h[r]+1518500249&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;for(r=20;r<=39;r++)l=t(o,5)+(s^c^d)+u+h[r]+1859775393&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;for(r=40;r<=59;r++)l=t(o,5)+(s&c|s&d|c&d)+u+h[r]+2400959708&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;for(r=60;r<=79;r++)l=t(o,5)+(s^c^d)+u+h[r]+3395469782&4294967295,u=d,d=c,c=t(s,30),s=o,o=l;f=f+o&4294967295,m=m+s&4294967295,v=v+c&4294967295,g=g+d&4294967295,p=p+u&4294967295}return(l=n(f)+n(m)+n(v)+n(g)+n(p)).toLowerCase()}}])}();function m(e){this.foundVideoPlayers=[],this.SearchForNewVideoPlayersInterval=5e3,this.newVideoFoundCallback=e,this.init=function(){this.trackVideos()},this.trackVideos=function(){this.searchForVideosInWindow(window);var e=window.document.getElementsByTagName("iframe"),t=this;function n(e){var n=!1;try{n=e.contentWindow}catch(i){return}n&&t.searchForVideosInWindow(e.contentWindow)}for(var i=0;i<e.length;i++)n(e[i]);setTimeout((function(){t.trackVideos()}),this.SearchForNewVideoPlayersInterval)},this.searchForVideosInWindow=function(e){try{e.jwplayer}catch(t){return}this.searchForFlowPlayerPlayersInWindow(e),this.searchForJWPlayerPlayersInWindow(e),this.searchForVideoJSPlayersInWindow(e)},this.searchForFlowPlayerPlayersInWindow=function(e){if(e.flowplayer){var t=[],n=0;if(void 0===e.flowplayer.instances)return;for(e.flowplayer.instances.forEach((function(e){t.push(e)})),n=0;n<t.length;n++)this.foundVideoPlayers.indexOf(t[n])<0&&(this.foundVideoPlayers.push(t[n]),this.newVideoFoundCallback("flowPlayer",e.flowplayer.version,t[n]))}},this.searchForJWPlayerPlayersInWindow=function(e){if(e.jwplayer){var t=[],n=e.jwplayer.version;for(i=0;e.jwplayer(i)&&e.jwplayer(i).id;)t.push(e.jwplayer(i)),i++;for(var i=0;i<t.length;i++){for(var r=!0,a=0;a<this.foundVideoPlayers.length;a++)this.foundVideoPlayers[a].id&&this.foundVideoPlayers[a].id==t[i].id&&(r=!1);r&&(this.foundVideoPlayers.push(t[i]),this.newVideoFoundCallback("jwPlayer",t[i].version?t[i].version:n,t[i]))}}},this.searchForVideoJSPlayersInWindow=function(e){if(e.videojs&&"object"==s(e.videojs.players))for(var t in e.videojs.players){var n=e.videojs.players[t];n&&this.foundVideoPlayers.indexOf(n)<0&&(this.foundVideoPlayers.push(n),this.newVideoFoundCallback("videojs",e.videojs.VERSION,n))}}}function v(){var e;try{e=window.localStorage;var t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(n){return!1}}function g(e){if(v())for(var t in e)e.hasOwnProperty(t)&&window.localStorage.setItem(t+"",e[t])}function p(e){return v()?window.localStorage.getItem(e+""):null}function S(e,t,i,o){this.urlDecoratedPropertyName="dmid",this.domainsInMeasurement=[],this.Core=e,this.SettingsObject=t,this.domainCookie=i,this.domainCookieTs=o,this.listenForVisitor=function(){if(this.domainCookie&&this.domainCookie!==d.NULL_COOKIE_VALUE&&this.SettingsObject.UrlDecoratorEnabled){var e=this;try{!function(){if(window.location.href.includes(e.urlDecoratedPropertyName)){var t=window.location.href.indexOf(e.urlDecoratedPropertyName);if(!((new Date).getTime()-e.domainCookieTs<d.TIME_STAMP_LIMIT_24_HOURS)){var n=window.location.href.substring(t+e.urlDecoratedPropertyName.length+1,window.location.href.length);e.domainCookie!==n&&n!==d.NULL_COOKIE_VALUE&&e.Core.performAjaxPost(e.Core.baseUrlPrefix+u.DOMAIN_SYNC_URL,{dcd:n,dc:e.domainCookie,ecid:e.SettingsObject.EventChainId})}var i=window.location.href.slice(0,t-1);history.replaceState({},"",i)}}();var t=Array.from(document.querySelectorAll("a")).filter((function(e){return e.href})),i=a(new Set(t.map((function(e){var t;try{if((t=new URL(e.href).hostname).includes("www."))return t.slice(4)}catch(n){return""}return t})).filter((function(e){return e&&e.length})))),o=r(function(){var t=[],n=[],r=DotmetricsJSON.parse(p("DotmetricsDIM"));if(r)return e.domainsInMeasurement=r.filter((function(e){for(var t in e){if(!0===e[t])return!0;break}return!1})).map((function(e){for(var t in e)return t})),i.forEach((function(e){r.find((function(t){return Object.keys(t)[0]===e}))?n.push(e):t.push(e)})),[t,n];return[i,[]]}(),2),s=o[0],c=o[1];s.length?this.Core.performAjaxPost(e.Core.baseUrlPrefix+u.UIMUrl,{id:e.SettingsObject.SiteSectionId,d:s},(function(t){var r=a(new Set([].concat(a(e.domainsInMeasurement),a(DotmetricsJSON.parse(t)))));e.domainsInMeasurement.length||(e.domainsInMeasurement=r);s=[].concat(a(r),a(c)),o=i.map((function(e){return s.includes(e)?n({},e,!0):n({},e,!1)})),g({DotmetricsDIM:DotmetricsJSON.stringify(o)}),e.listenForHyperlinkClicks();var o;var s})):e.listenForHyperlinkClicks()}catch(l){e.Core.sendScriptError(l)}}},this.listenForHyperlinkClicks=function(){var e=this;try{window.addEventListener("click",(function(t){e.checkIfHyperlinkAndInjectId(t,e)}))}catch(t){e.Core.sendScriptError(t)}},this.checkIfHyperlinkAndInjectId=function(e,t){try{var n=function(e){if(!e.hasAttribute("href"))return e.closest("a[href]");return e}(e.target),i=n?n.getAttribute("href"):null;i&&!i.includes(window.location.hostname)&&i.includes("http")&&!i.includes("#")&&function(){try{return t.domainsInMeasurement.find((function(e){return e===new URL(i).hostname.replace("www.","")}))}catch(e){return!1}}()&&(i+="#".concat(t.urlDecoratedPropertyName,"=")+encodeURIComponent(t.domainCookie),n.href=i)}catch(r){t.Core.sendScriptError(r)}}}function y(e,t,n,i){var r=new Date;r.setDate(r.getDate()+n);t=escape(t)+(null==n?"":"; expires="+r.toUTCString());document.cookie=e+"="+t+";path=/;secure;"}function w(e){return D(e)?function(e){for(var t,n=document.cookie.split(";"),i={},r=0,a=n.length;r<a;++r)if((t=n[r].split("="))[0]=t[0].replace(/^\s+|\s+$/,""),!C(e)||e.test(t[0]))try{i[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}catch(o){}return i}()[e+""]:null}function D(e){return new RegExp("(?:;\\s*|^)"+encodeURIComponent(e+"")+"=").test(document.cookie)}function C(e){return"[object RegExp]"==Object.prototype.toString.call(e)}function T(e){function t(e){for(var t={},n=Object.keys(e).sort((function(e,t){return e.localeCompare(t)})),i=0;i<n.length;i++)t[n[i]]=e[n[i]];return t}this.dataSendCount=0,this.pingSendCount=0,this.formPostCount=0,this.SettingsObject=e,this.baseUrlPrefix=this.SettingsObject.BaseUrl,this.sendData=function(e,t){switch(e){case this.baseUrlPrefix+u.DATA_URL:if(this.dataSendCount++,this.dataSendCount>d.CALL_LIMIT)return;break;case this.baseUrlPrefix+u.PING_URL:if(this.pingSendCount++,this.pingSendCount>d.CALL_LIMIT)return}var n="";if(null!=t){var i=f.encode(DotmetricsJSON.stringify(t));n="&v="+(i=encodeURIComponent(i))}var r=e+"?r="+(new Date).getTime()+n,a=document.createElement("script");a.setAttribute("src",r);var o=document.getElementsByTagName("head")[0]||document.head||document.body;try{o.appendChild(a)}catch(c){var s="";try{s=document.documentElement.outerHTML}catch(l){}this.sendScriptError(c,{doc:s})}},this.performAjaxPost=function(e,t,n){var i=f.encode(DotmetricsJSON.stringify(t));i=encodeURIComponent(i);var r=(new Date).getTime(),a="v="+i+"&r="+r;e+="?"+r;var o=new XMLHttpRequest;o.open("POST",e,!0),o.withCredentials=!0,o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n&&o.addEventListener("loadend",(function(){n(o.response)})),o.send(a)},this.performFPPost=function(e,t,n){var i=f.encode(DotmetricsJSON.stringify(t));i=encodeURIComponent(i);var r=(new Date).getTime(),a="v="+i+"&r="+r;e+="?"+r;var o=new XMLHttpRequest;o.open("POST",e,!0),o.withCredentials=!0,o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n&&o.addEventListener("loadend",(function(){n(o.response)})),o.send(a)},this.performSendBeacon=function(e,t){this.sendMessageToExtension({target:"dotmetrics-extension",type:"beacon",url:e,data:t});var n=f.encode(DotmetricsJSON.stringify(t));n=encodeURIComponent(n);var i=(new Date).getTime(),r=new Blob(["v="+n+"&r="+i],{type:"application/x-www-form-urlencoded"});try{return b.boundBeacon(e,r)}catch(a){return!1}},this.addEventSimple=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},this.removeEventSimple=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},this.isIE=function(){return-1!=navigator.appName.indexOf("Microsof")},this.sortByProperty=function(e,t,n){return e.sort((function(e,i){return e[t]<i[t]?"asc"===n?1:-1:e[t]>[t]?"asc"===n?-1:1:0}))},this.CreateElement=function(e,t,n){if(null!=e){var i=document.createElement(e);if(null!=t)for(x in t)"function"==typeof t[x]?this.addEventSimple(i,x,t[x]):(i.setAttribute(x,t[x]),"class"==x&&(i.className=t[x]));if(null!=n){var r=document.createTextNode(n.toString());i.appendChild(r)}return i}return null!=n?document.createTextNode(n.toString()):null},this.clientInfo=null,this.clientInfoTimingData=null,this.createClientInfo=function(e){if(this.clientInfo)e&&e();else{this.clientInfoTimingData={};var t=(new Date).getTime(),n={};n.AppCodeName=window.navigator.appCodeName,n.AppName=window.navigator.appName,n.Version=window.navigator.appVersion,n.Language=window.navigator.language,n.Platform=window.navigator.platform,n.Product=window.navigator.product,n.ProductSub=window.navigator.productSub,n.UserAgent=window.navigator.userAgent,n.Vendor=window.navigator.vendor,n.VendorSub=window.navigator.vendorSub,n.BuildId=window.navigator.buildID,n.OsCpu=window.navigator.oscpu,n.Screen={},n.Screen.AvailableWidth=window.screen.availWidth,n.Screen.AvailableHeight=window.screen.availHeight,n.Screen.PixelDepth=window.screen.pixelDepth,n.Screen.ColorDepth=window.screen.colorDepth;var i=window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI;if(n.Screen.Width=Math.round(window.screen.width*i),n.Screen.Height=Math.round(window.screen.height*i),null==n.Screen.Width&&(n.Screen.Width=n.Screen.AvailableWidth),null==n.Screen.Height&&(n.Screen.Height=n.Screen.AvailableHeight),n.Plugins=[],window.ActiveXObject){var r=/[0-9]+/,a={flash:"ShockwaveFlash.ShockwaveFlash",pdf:"AcroPDF.PDF",silverlight:"AgControl.AgControl",quicktime:"QuickTime.QuickTime"};for(var o in a){var s=this.msieDetect(a[o]);if(s){var c=r.exec(s);s=c&&c[0]||"";var d={};d.Name=a[o],d.FileName="",n.Plugins.push(d)}}}else for(var u=0;u<window.navigator.plugins.length;u++){if(void 0!==(o=window.navigator.plugins[u]))(f={}).Name=o.name,f.FileName=o.filename,n.Plugins.push(f)}n.MimeTypes=[];var h;for(u=0;h=window.navigator.mimeTypes[u];u++){var f;(f={}).Type=h.type,f.Suffixes=h.suffixes,n.MimeTypes.push(f)}t=(new Date).getTime()-t,this.clientInfoTimingData.basicInfoTime=t;var m=(new Date).getTime();n.Canvas=this.CreateCanvasFP(),m=(new Date).getTime()-m,this.clientInfoTimingData.canvasInfoTime=m;var v="",g=new function(){var e=["monospace","sans-serif","serif"],t=document.getElementsByTagName("body")[0],n=document.createElement("span");n.style.fontSize="72px",n.innerHTML="mmmmmmmmmmlli";var i={},r={};for(var a in e)n.style.fontFamily=e[a],t.appendChild(n),i[e[a]]=n.offsetWidth,r[e[a]]=n.offsetHeight,t.removeChild(n);this.detect=function(a){var o=!1;for(var s in e){n.style.fontFamily=a+","+e[s],t.appendChild(n);var c=n.offsetWidth!=i[e[s]]||n.offsetHeight!=r[e[s]];t.removeChild(n),o=o||c}return o}},p=this,S=(u=0,(new Date).getTime());setTimeout((function(){y()}),20)}function y(){var t=g.detect(l[u]);v+=t?"1":"0",++u>=l.length?(n.FontString=v,p.clientInfo=n,S=(new Date).getTime()-S,p.clientInfoTimingData.fontInfoTime=S,e()):setTimeout((function(){y()}),30)}},this.domainFPData=null,this.runDomainFP=function(e){null!=this.domainFPData&&e(this.domainFPData);var t={},n={},i=this,r=(new Date).getTime(),a=0,o=setInterval((function(){a+=c}),100);this.runEdi({callback:function(){var s=f.SHA1(DotmetricsJSON.stringify(t));t.unstable&&(s+="_unstable"),clearInterval(o);var c=(new Date).getTime();n={t:c-r,tInt:a},i.domainFPData={dfp:t,dfph:s.toString(),timingData:n},e(i.domainFPData)},ediDataObject:t,asyncTestList:this.domainFpAsyncTests,syncTestList:this.domainFpSyncTests})};var r=this;this.domainFpSyncTests=[function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.runHasLocalStorageFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.runBluetoothAPI(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createWebglFP(e,t,[{numTriangles:1,vertexData:[-.876,-.65634,0,.8634,-.85673,0,0,.7234,0],colorData:[.986,.12,.55,0,1,0,0,0,1],imageName:"Img1"}])},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createForcedColorsFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createDynamicContrastFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createMonochromaticFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createTransparencyFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createArchitectureFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createMathCalculationsFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createSampleRateFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createMotionFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createColorGamutFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createTouchSupportFp(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createNavigatorFP(e,t,{testWidth:!1})},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.browserFeaturesFP(e,t)},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.createWebGlPropertiesFp(e,t)}],this.domainFpAsyncTests=[function(e,t,n){r.runMediaDeviceInfoFp({callback:e,ediDataObject:t,timingDataObject:n,testInfo:!1,testCount:!0})},function(e,t,n){r.createAudioFp("triangle",e,t,n)},function(e,t,n){r.createDomainFontFP({resultProperty:"expFontsOld",testFonts:h,callback:e},t,n)},function(e,t,n){r.createNewCanvasFP({callback:e,ediDataObject:t,timingDataObject:n,options:{renderText:!1,renderGeometry:!0}})},function(e,t,n){r.createPermissionsAndSensorFP(e,t,n)}],this.runEdi=function(e){for(var t=e.callback,n=e.ediDataObject,i=e.timingDataObject,r=void 0===i?{}:i,a=e.asyncTestList,o=e.syncTestList,s=0;s<o.length;s++)o[s](n,r);var c=0;!function e(){c<a.length?setTimeout((function(){a[c](e,n,r),c++}),20):t()}()},this.browserFeaturesFP=function(e,t){var r=(new Date).getTime(),a={style:{elem:document.createElement("dotmetrics")}.elem.style};function o(e){return e.replace(/([a-z])-([a-z])/g,(function(e,t,n){return t+n.toUpperCase()})).replace(/^-/,"")}function c(e,t,n,i,r){var s=e.charAt(0).toUpperCase()+e.slice(1),c=(e+" "+"Moz O ms Webkit".split(" ").join(s+" ")+s).split(" ");return h(t,"string")||h(t,"undefined")?function(e,t,n,i){if(i=!h(i,"undefined")&&i,!h(n,"undefined")){var r=function(e,t){var n=e.length;if("CSS"in window&&"supports"in window.CSS){for(;n--;)if(window.CSS.supports(u(e[n]),t))return!0;return!1}if("CSSSupportsRule"in window){for(var i=[];n--;)i.push("("+u(e[n])+":"+t+")");return i=i.join(" or "),injectElementWithStyles("@supports ("+i+") { #dotmetrics { position: absolute; } }",(function(e){return"absolute"===computedStyle(e,null,"position")}))}return}(e,n);if(!h(r,"undefined"))return r}var s,c,l,f,m,v=["dotmetrics","tspan","samp"];for(;!a.style&&v.length;)s=!0,a.modElem=document.createElement(v.shift()),a.style=a.modElem.style;function g(){s&&(delete a.style,delete a.modElem)}for(l=e.length,c=0;c<l;c++)if(f=e[c],m=a.style[f],d(f,"-")&&(f=o(f)),void 0!==a.style[f]){if(i||h(n,"undefined"))return g(),"pfx"!==t||f;try{a.style[f]=n}catch(p){}if(a.style[f]!==m)return g(),"pfx"!==t||f}return g(),!1}(c,t,i,r):function(e,t,n){var i;for(var r in e)if(e[r]in t)return!1===n?e[r]:h(i=t[e[r]],"function")?l(i,n||t):i;return!1}(c=(e+" "+"Moz O ms Webkit".toLowerCase().split(" ").join(s+" ")+s).split(" "),t,n)}function d(e,t){return!!~(""+e).indexOf(t)}function u(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^ms-/,"-ms-")}function l(e,t){return function(){return e.apply(t,arguments)}}function h(e,t){return s(e)===t}function f(e){var t=document.createElement("video"),n={};try{t.canPlayType&&("video.ogg"===e&&(n["video.ogg"]=t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")),"video.hls"===e&&(n["video.hls"]=t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")))}catch(i){}return t.remove(),n}function m(e){var t=e(),n="";if("object"===s(t))for(var i in t)n+=1==t[i]?"1":"0";else n+=1==t?"1":"0";return n}for(var v=[function(){var e=!1;try{e="SVGFEColorMatrixElement"in window&&2===SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE}catch(t){}return e},function(){return"openDatabase"in window},function(){return f("video.hls")},function(){return"Worker"in window},function(){return"capture"in document.createElement("input")},function(){return f("video.ogg")},function(){return e="search",i=!("onblur"in document),t&&"string"!=typeof t||(t=document.createElement(t||"div")),!(n=(e="on"+e)in t)&&i&&(t.setAttribute||(t=document.createElement("div")),t.setAttribute(e,""),n="function"==typeof t[e],"undefined"!==t[e]&&(t[e]=void 0),t.removeAttribute(e)),n;var e,t,n,i},function(){return c("translate","45px",!0)},function(){return"applicationCache"in window},function(){return c("backdropFilter")},function(){return c("fontVariationSettings")},function(){return"import"in document.createElement("link")},function(){return c("scrollSnapType")},function(){var e=document.createElement("canvas");return{emoji:!!(!!(!!e.getContext&&!!e.getContext("2d"))&&"function"==typeof e.getContext("2d").fillText)&&function(){var t=e.getContext("2d"),n=12*(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1);t.fillStyle="#f00",t.textBaseline="top",t.font="32px Arial",t.fillText("ðŸ¨",0,0);var i=t.getImageData(0,0,n,n);return!(!i||!i.data)&&0!==i.data[0]}()}},function(){return!!(Array.prototype&&Array.prototype.copyWithin&&Array.prototype.fill&&Array.prototype.find&&Array.prototype.findIndex&&Array.prototype.keys&&Array.prototype.entries&&Array.prototype.values&&Array.from&&Array.of)},function(){var e=document.createElement("canvas");return{todataurlwebp:function(t){var n=!1;try{n=0===e.toDataURL("image/"+t).indexOf("data:image/"+t)}catch(i){}return n}("webp")}},function(){var e=!1;try{e="WebSocket"in window&&2===window.WebSocket.CLOSING}catch(t){}return e},function(){var e,t=document.createElement("audio");return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t.canPlayType?{"audio.m4a":(e=(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),"function"==typeof e?e():e)}:{})}],g="",p=0;p<v.length;p++)g+=m(v[p]);var S=(new Date).getTime();e.browserFeatures=g,t.browserFeatures=S-r},this.createWebGlPropertiesFp=function(e,t){var n=this;n.startFPTimer();var i=(new Date).getTime();try{var r,a=function(e){try{return e()}catch(t){return""}},o=document.createElement("canvas");o.width=100,o.height=100,o.style.display="none";try{document.body.appendChild(o)}catch(m){return void f()}for(var s=(r=window.WebGL2RenderingContext&&o.getContext("webgl2",{stencil:!0})?window.WebGL2RenderingContext:window.WebGLRenderingContext)===window.WebGL2RenderingContext?["webgl2","experimental-webgl2"]:["webgl","experimental-webgl"],c=null,d={},u=0;u<s.length;u++)if(c=o.getContext(s[u],{stencil:!0})){s[u];break}if(!c)return void f();d.unMaskedVendor=a((function(){return l(c).vendor})),d.unMaskedRenderer=a((function(){return l(c).renderer})),d.extensions=c.getSupportedExtensions()?a((function(){return c.getSupportedExtensions().join(",")})):"",r===window.WebGL2RenderingContext&&(d.maxCombinedUniformBlocks=c.MAX_COMBINED_UNIFORM_BLOCKS?a((function(){return c.getParameter(c.MAX_COMBINED_UNIFORM_BLOCKS)})):null,d.maxCombinedVertexUniformComponents=c.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS?a((function(){return c.getParameter(c.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)})):null),d.maxViewportDimensions=a((function(){return h(c.getParameter(c.MAX_VIEWPORT_DIMS))})),d.maxCombinedTextureImageUnits=a((function(){return c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS)})),d.maxRenderBufferSize=a((function(){return c.getParameter(c.MAX_RENDERBUFFER_SIZE)})),r===window.WebGL2RenderingContext&&(d.maxTransformFeedbackInterleavedComponents=c.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS?a((function(){return c.getParameter(c.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)})):null,d.max3dTextureSize=c.MAX_3D_TEXTURE_SIZE?a((function(){return c.getParameter(c.MAX_3D_TEXTURE_SIZE)})):null,d.maxArrayTextureLayers=c.MAX_ARRAY_TEXTURE_LAYERS?a((function(){return c.getParameter(c.MAX_ARRAY_TEXTURE_LAYERS)})):null,d.maxSamples=c.MAX_SAMPLES?a((function(){return c.getParameter(c.MAX_SAMPLES)})):null),d.aliasedPointSizeRange=a((function(){return h(c.getParameter(c.ALIASED_POINT_SIZE_RANGE))})),e.webGlProps=DotmetricsJSON.stringify(d),t.webGlTime=(new Date).getTime()-i,t.webGlTimeInt=n.stopFPTimer()}catch(m){n.sendScriptError(m)}function l(e){var t={renderer:"",vendor:""},n=e.getExtension("WEBGL_debug_renderer_info");return null!=n&&(t.renderer=e.getParameter(n.UNMASKED_RENDERER_WEBGL),t.vendor=e.getParameter(n.UNMASKED_VENDOR_WEBGL)),t}function h(e){return"["+e[0]+", "+e[1]+"]"}function f(){o&&o.remove(),e.webGlProps="failed",t.webGlTime=(new Date).getTime()-i,t.webGlTimeInt=n.stopFPTimer()}},this.createNavigatorFP=function(e,t){var n={};n.AvailableHeight=window.screen.availHeight,n.Height=Math.round(window.screen.height*devicePixelRatio),n.UserAgent=window.navigator.userAgent,n.Version=window.navigator.appVersion,n.OsCpu=window.navigator.oscpu,n.ColorDepth=window.screen.colorDepth,n.PixelDepth=window.screen.pixelDepth,t.testWidth&&(e.AvailableWidth=window.screen.availWidth,e.Width=Math.round(window.screen.width*devicePixelRatio)),e.Language=window.navigator.language.split("-")[0],e.navigatorProps=n},this.createPermissionsAndSensorFP=function(e,n,i){var r=this,a=(new Date).getTime();r.startFPTimer();var o={},s=["background-sync","payment-handler","accelerometer","gyroscope","magnetometer","ambient-light-sensor","midi"];try{for(var c=0;c<s.length;c++)l(s[c])}catch(h){this.sendScriptError(h),e()}function d(){var s={},c={absoluteOrientationSensor:function(){var e=!1;"function"==typeof AbsoluteOrientationSensor&&(e=AbsoluteOrientationSensor);u(e,"absoluteOrientationSensor",["accelerometer","gyroscope","magnetometer"])},accelerometer:function(){var e=!1;"function"==typeof Accelerometer&&(e=Accelerometer);u(e,"accelerometer",["accelerometer"])},magnetometer:function(){var e=!1;"function"==typeof Magnetometer&&(e=Magnetometer);u(e,"magnetometer",["magnetometer"])},gyroscope:function(){var e=!1;"function"==typeof Gyroscope&&(e=Gyroscope);u(e,"gyroscope",["gyroscope"])},gravity:function(){var e=!1;"function"==typeof GravitySensor&&(e=GravitySensor);u(e,"gravity",["accelerometer"])},linearAcceleration:function(){var e=!1;"function"==typeof LinearAccelerationSensor&&(e=LinearAccelerationSensor);u(e,"linearAcceleration",["accelerometer"])},relativeOrientation:function(){var e=!1;"function"==typeof RelativeOrientationSensor&&(e=RelativeOrientationSensor);u(e,"relativeOrientation",["accelerometer","gyroscope"])},ambientLight:function(){var e=!1;"function"==typeof AmbientLightSensor&&(e=AmbientLightSensor);u(e,"ambientLight",["ambient-light-sensor"])}};for(var d in c)c[d]();function u(d,u,l){var f={hasReading:!1};if(d)try{var m=function(){clearTimeout(v),g(),f.removeEventListener("reading",m),f.stop()};if(l.every((function(e){return"granted"===o[e]}))){(f=new d({frequency:60})).addEventListener("reading",m),f.start();var v=setTimeout(m,1e3)}else g()}catch(h){g()}else g();function g(){s[u]=f.hasReading,Object.keys(s).length===Object.keys(c).length&&(n.sensors=t(s),n.permissions=t(o),i.sensorsPermissionTiming=(new Date).getTime()-a,i.sensorsPermissionTimingInt=r.stopFPTimer(),e())}}}function u(){Object.keys(o).length===Object.keys(s).length&&d()}function l(e){try{navigator.permissions.query({name:e}).then((function(t){o[e]=t.state,u()})).catch((function(){o[e]="Unsupported",u()}))}catch(h){o[e]="Unsupported",u()}}},this.createNewCanvasFP=function(e){var t=e.callback,n=e.ediDataObject,i=e.timingDataObject,r=e.options,a=this,o=(new Date).getTime();a.startFPTimer();try{!function(e,t,n){var i,r,a=!1,o=document.createElement("canvas");o.width=1,o.height=1;var d=o.getContext("2d");if(!d||!o.toDataURL)return i=r="unsupported",{winding:a,geometry:i,text:r};a=function(e){return e.rect(0,0,10,10),e.rect(2,2,6,6),!e.isPointInPath(5,5,"evenodd")}(d),function(e,t,n,i,r){var a,o,d,u;i&&(s(e,t),setTimeout((function(){a=e.toDataURL(),s(e,t),setTimeout((function(){o=e.toDataURL(),a!==o&&(a="unstable"),l()}),0)}),0));r&&(c(e,t),setTimeout((function(){d=e.toDataURL(),c(e,t),setTimeout((function(){u=e.toDataURL(),d!==u&&(d="unstable"),l()}),0)}),0));function l(){r&&i&&d&&u&&a&&o?n([d,a]):r&&!i&&d&&u?n([d]):i&&!r&&a&&o&&n([a])}}(o,d,(function(t){i=t[0],r=t[1],e({winding:a,geometry:i,text:r})}),t,n)}((function(e){var r=(new Date).getTime()-o;n.canvas={},e.geometry&&(n.canvas.geometry=s(e.geometry));e.text&&(n.canvas.text=s(e.text));function s(e){return"unstable"===e&&(n.unstable=!0),"unstable"===e||"unsupported"===e?e:f.SHA1(e).toString()}n.canvas.winding=e.winding,i.newCanvasTiming=r,i.newCanvasTimingInt=a.stopFPTimer(),t()}),r.renderText,r.renderGeometry)}catch(d){this.sendScriptError(d),t()}function s(e,t){e.width=240,e.height=60,t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(100,1,62,20),t.fillStyle="#069",t.font='11pt "Times New Roman"';var n="The quick brown fox jumps over the lazy dog  /* ðŸ˜ƒ */"+String.fromCharCode(55357,56835);t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.2)",t.font="18pt Arial",t.fillText(n,4,45)}function c(e,t){e.width=122,e.height=110,t.globalCompositeOperation="multiply";for(var n=[{color:"#f2f",x:40,y:40},{color:"#2ff",x:80,y:40},{color:"#ff2",x:60,y:80}],i=0;i<n.length;i++)t.fillStyle=n[i].color,t.beginPath(),t.arc(n[i].x,n[i].y,40,0,2*Math.PI,!0),t.closePath(),t.fill();t.fillStyle="#f9c",t.arc(60,60,60,0,2*Math.PI,!0),t.arc(60,60,20,0,2*Math.PI,!0),t.fill("evenodd")}},this.createTouchSupportFp=function(e){try{var t=function(){var e,t=0;void 0!==navigator.maxTouchPoints?t=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(t=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),e=!0}catch(i){e=!1}var n="ontouchstart"in window;return{maxTouchPoints:t,touchEvent:e,touchStart:n}}();e.touchSupport={maxTouchPoints:t.maxTouchPoints,touchEvent:t.touchEvent,touchStart:t.touchStart}}catch(n){this.sendScriptError(n)}},this.createColorGamutFp=function(e){try{var t={srgb:window.matchMedia("(color-gamut: srgb)").matches,p3:window.matchMedia("(color-gamut: p3)").matches,rec2020:window.matchMedia("(color-gamut: rec2020)").matches};for(var n in t)if(t[n]){t=n;break}"object"!==s(t)?e.colorGamut=t:e.colorGamut=""}catch(i){this.sendScriptError(i)}},this.createMotionFp=function(e){try{e.motionPreferred=!window.matchMedia("(prefers-reduced-motion: no-preference)").matches}catch(t){this.sendScriptError(t)}},this.createSampleRateFp=function(e){try{if(!window.AudioContext&&!window.webkitAudioContext)return void(e.sampleRate={sampleRate:0,maxChannelCount:0,outputLatency:0});var t=new(window.AudioContext||window.webkitAudioContext);e.sampleRate={sampleRate:t.sampleRate,maxChannelCount:t.destination.maxChannelCount,outputLatency:t.outputLatency}}catch(n){this.sendScriptError(n)}},this.createMathCalculationsFP=function(e){try{var t=function(){return 0},n=function(e){return e||0},i=Math.acos||t,r=Math.acosh||t,a=Math.asin||t,o=Math.asinh||t,s=Math.atanh||t,c=Math.atan||t,d=Math.sin||t,u=Math.sinh||t,l=Math.cos||t,h=Math.cosh||t,f=Math.tan||t,m=Math.tanh||t,v=Math.exp||t,g=Math.expm1||t,p=Math.log1p||t,S={acos:n(i(.12312423423423424)),acosh:n(r(1e308)),asin:n(a(.12312423423423424)),asinh:n(o(1)),atanh:n(s(.5)),atan:n(c(.5)),sin:n(d(-1e300)),sinh:n(u(1)),cos:n(l(10.000000000123)),cosh:n(h(1)),tan:n(f(-1e300)),tanh:n(m(1)),exp:n(v(1)),expm1:n(g(1)),log1p:n(p(10)),powPI:n((D=-100,Math.pow(Math.PI,D))),acoshPf:n(function(e){return Math.log(e+Math.sqrt(e*e-1))}(1e154)),asinhPf:n(function(e){return Math.log(e+Math.sqrt(e*e+1))}(1)),atanhPf:n(function(e){return Math.log((1+e)/(1-e))/2}(.5)),sinhPf:n(function(e){return Math.exp(e)-1/Math.exp(e)/2}(1)),coshPf:n(function(e){return(Math.exp(e)+1/Math.exp(e))/2}(1)),expm1Pf:n(function(e){return Math.exp(e)-1}(1)),tanhPf:n(function(e){return(Math.exp(2*e)-1)/(Math.exp(2*e)+1)}(1)),log1pPf:n(function(e){return Math.log(1+e)}(10))},y=0;for(var w in S)y+=S[w]||0;"number"==typeof y&&Number.isFinite(y)?e.math=y:e.math=0}catch(C){e.math=0,this.sendScriptError(C)}var D},this.createArchitectureFP=function(e){try{var t=new Float32Array(1),n=new Uint8Array(t.buffer);t[0]=1/0,t[0]=t[0]-t[0],e.architecture=n[3]}catch(i){this.sendScriptError(i)}},this.createTransparencyFP=function(e){e.IsTransparencyPreferred=window.matchMedia("(prefers-reduced-transparency)").matches},this.createMonochromaticFP=function(e){e.isMonochromatic=window.matchMedia("(monochrome)").matches},this.createDynamicContrastFP=function(e){e.isHDREnabled=window.matchMedia("(dynamic-range: high)").matches},this.runMediaDeviceInfoFp=function(e){var t=e.callback,n=e.ediDataObject,i=e.timingDataObject,r=e.testInfo,a=e.testCount,o=this,s=(new Date).getTime();if(this.startFPTimer(),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then((function(e){if(r){n.mediaDeviceInfo=[];for(var c=0;c<e.length;c++)n.mediaDeviceInfo.push({deviceId:e[c].deviceId,groupId:e[c].groupId,kind:e[c].kind,label:e[c].label});n.mediaDeviceInfo=o.sortByProperty(n.mediaDeviceInfo,"kind","desc")}i.mediaDeviceInfoTime=(new Date).getTime()-s,i.mediaDeviceInfoTimeInt=o.stopFPTimer(),a&&(n.mediaDeviceInfoCount=function(e){for(var t=[],n=0;n<e.length;n++){for(var i=!1,r=0;r<t.length;r++)t[r].type===e[n].kind&&(i=!0,t[r].count++);i||t.push({type:e[n].kind,count:1})}return o.sortByProperty(t,"type","desc")}(e)),t()}))}catch(c){t(),this.sendScriptError(c)}},this.createAudioFp=function(e,t,n,i){var r,a=!1,o=!0,s=setTimeout((function(){g.removeEventListener("complete",f),r&&clearTimeout(r),u(-2)}),4e3);try{var c,d=this,u=function(r){a||(a=!0,n["audioFp"+e]=r,i["audioFp"+e]=(new Date).getTime()-c,i["audioFp"+e+"Int"]=d.stopFPTimer(),t())},l=function(){var e=0;try{c=(new Date).getTime(),d.startFPTimer(),++e>3&&u(-1),g.startRendering(),o&&(o=!1,h())}catch(n){t(),d.sendScriptError(n)}},h=function(){"suspended"===g.state&&(r=setTimeout((function(){l()}),500))},f=function(e){try{clearTimeout(s),m(e.renderedBuffer)}catch(n){t(),d.sendScriptError(n)}},m=function(e){var t=0;if(e&&e.getChannelData){var n=e.getChannelData(0);if(n.subarray)for(var i=n.subarray(4500),r=0;r<i.length;++r)t+=Math.abs(i[r])}u(t)},v=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(!v)return void u(-2);var g=new v(1,5e3,44100),p=g.createOscillator();p.type=e,p.frequency.value=1e4;var S=g.createDynamicsCompressor();S.threshold.value=-50,S.knee.value=40,S.ratio.value=12,S.attack.value=0,S.release.value=.25,p.connect(S),S.connect(g.destination),p.start(0),g.addEventListener("complete",f),l()}catch(y){t(),this.sendScriptError(y)}},this.msieDetect=function(e){try{var t=new ActiveXObject(e);try{return t.GetVariable("$version")}catch(r){try{return t.GetVersions()}catch(a){try{for(var n,i=1;i<9;i++)t.isVersionSupported(i+".0")&&(n=i);return n||!0}catch(o){return!0}}}}catch(r){return!1}},this.CreateCanvasFP=function(){var e=document.createElement("canvas");if(e.getContext&&e.getContext("2d")){e.width=250,e.height=250;for(var t=e.getContext("2d"),n=0;n<e.width/2;n++)t.moveTo(2*n,0),t.lineTo(4*n,e.height),t.strokeStyle="rgba(0, 0, 0, 0.1)",t.stroke();t.font="40px 'Arial'";for(n=0;n<3;n++)t.fillStyle="#41b4e7",t.fillText("Dotmetrics",10,50*n+75),t.fillStyle="rgba(255, 255, 255, 0.7)",t.fillText("Dotmetrics",20,50*n+75);var i=e.toDataURL("image/jpeg",1);return f.SHA1(i).toString()}return null},this.runHasLocalStorageFp=function(e){e.hasLocalStorage=v()},this.runBluetoothAPI=function(e){e.bluetoothAPI=!!window.navigator.bluetooth},this.createWebglFP=function(e,t,n){function i(n){var i,r,a=n.numTriangles,o=n.vertexData,s=n.colorData,c=n.imageName,d=(new Date).getTime();(i=document.createElement("canvas")).width=256,i.height=128,r=i.getContext("webgl2")||i.getContext("experimental-webgl2")||i.getContext("webgl")||i.getContext("experimental-webgl")||i.getContext("moz-webgl");var u=null;try{var l=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,l);var h=new Float32Array(o);r.bufferData(r.ARRAY_BUFFER,h,r.STATIC_DRAW),l.itemSize=3,l.numItems=a;var m=new Float32Array(s),v=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,v),r.bufferData(r.ARRAY_BUFFER,m,r.STATIC_DRAW),v.itemSize=3,v.numItems=a;var g=r.createProgram(),p=r.createShader(r.VERTEX_SHADER);r.shaderSource(p,"attribute vec3 attrVertex;attribute vec3 color;varying vec3 vColor;void main(){gl_Position=vec4(attrVertex,1);vColor=color;}"),r.compileShader(p);var S=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(S,"precision mediump float;varying vec3 vColor;void main(){gl_FragColor=vec4(vColor,1);}"),r.compileShader(S),r.attachShader(g,p),r.attachShader(g,S),r.linkProgram(g),r.useProgram(g),r.bindBuffer(r.ARRAY_BUFFER,l),g.vertexPosAttrib=r.getAttribLocation(g,"attrVertex"),g.offsetUniform=r.getUniformLocation(g,"uniformOffset"),r.enableVertexAttribArray(g.vertexPosArray),r.vertexAttribPointer(g.vertexPosAttrib,l.itemSize,r.FLOAT,!1,0,0),r.uniform2f(g.offsetUniform,1,1),r.bindBuffer(r.ARRAY_BUFFER,v);var y=r.getAttribLocation(g,"color");r.enableVertexAttribArray(y),r.vertexAttribPointer(y,v.itemSize,r.FLOAT,!1,0,0),r.drawArrays(r.TRIANGLES,0,3*l.numItems);var w=i.toDataURL("image/jpeg",1);u=f.SHA1(w).toString()}catch(C){}var D=(new Date).getTime();e["webglFp"+c]=u,t["webglFp"+c]=D-d}for(var r=0;r<n.length;r++)i(n[r])},this.createDomainFontFP=function(e,t,n){var i=e.resultProperty,r=e.testFonts,a=e.callback,o=this.createFontTestIframe();try{o.onload=function(){var e=["monospace","sans-serif","serif"],n="thequickbrownfoxjumpsoverthelazydogTHEQUICKBROWNFOXJUMPSOVERTHELAZYDOG0123456789#&!?",s=o.contentDocument.body;s.style.fontSize="72px";var c=o.contentDocument.createElement("div");c.style.setProperty("visibility","hidden","important");var d={},u={};function l(e){var t=o.contentDocument.createElement("span");return t.style="position: absolute; top: 0; left: 0; font-family: "+e+";",t.textContent=n,c.appendChild(t),t}function h(e,t){return l(e+","+t)}function f(t){for(var n=!1,i=0;i<e.length;i++)t[i].offsetWidth===d[e[i]]&&t[i].offsetHeight===u[e[i]]||(n=!0);return n}var m=function(){for(var t={},n=0;n<e.length;n++)t[e[n]]=l(e[n]);return t}(),v=function(){for(var t={},n=0;n<r.length;n++)t[r[n]]=e.map((function(e){return h(r[n],e)}));return t}();s.appendChild(c),setTimeout((function(){for(var n=0;n<e.length;n++)d[e[n]]=m[e[n]].offsetWidth,u[e[n]]=m[e[n]].offsetHeight;var s="";for(n=0;n<r.length;n++){var c=r[n];s+=f(v[c])?"1":"0"}"1"===s[s.length-1]&&(t.unstable=!0),t[i]=s,document.body.removeChild(o),a()}),0)}}catch(s){this.sendScriptError(s),document.body.removeChild(o)}},this.createForcedColorsFP=function(e,t){var n=(new Date).getTime(),i=window.matchMedia("(forced-colors: active)").matches,r=(new Date).getTime();e.forcedColors=i,t.forcedColors=r-n},this.createFontTestIframe=function(){var e=document.createElement("iframe");return e.style.display="block !important",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.visibility="hidden",e.srcdoc='<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1">',document.body.appendChild(e),e};var a=0,o=null,c=100;this.startFPTimer=function(){a=0,o=setInterval((function(){a+=c}),c)},this.stopFPTimer=function(){return clearInterval(o),a},this.getNetworkInformation=function(){var e=null;try{if(void 0!==window.navigator.connection){var t=window.navigator.connection;e={et:t.effectiveType,dl:t.downlink,dlm:t.downlinkMax,rtt:t.rtt,sd:t.saveData,t:t.type}}}catch(n){this.sendScriptError(n)}return e},this.CreateElement=function(e,t,n){if(null!=e){var i=document.createElement(e);if(null!=t)for(var r in t)"function"==typeof t[r]?this.addEventSimple(i,r,t[r]):(i.setAttribute(r,t[r]),"class"==r&&this.isIE()&&(i.className=t[r]));if(null!=n){var a=document.createTextNode(n.toString());i.appendChild(a)}return i}return null!=n?document.createTextNode(n.toString()):null},this.sendMessageToExtension=function(e,t){window.sendMessageToDotmetricsExtension&&window.sendMessageToDotmetricsExtension(e,t)},this.postMessage=function(e,t){try{void 0!==t?t.postMessage(e,"*"):window.postMessage(e,"*")}catch(n){}};var m=!1;this.sendScriptError=function(e,t){if(!m){m=!0;var n={type:"script",ecid:this.SettingsObject.EventChainId,details:t||{},name:e&&e.name?e.name:"",message:e&&e.message?e.message:"",stack:e&&e.stack?e.stack:"",sectionId:this.SettingsObject.SiteSectionId,pageUrl:window.location.href};this.performAjaxPost(this.baseUrlPrefix+u.ERROR_EVENT_URL,n)}},this.findMedian=function(e){e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2==0?(e[t-1]+e[t])/2:e[t]},this.calculateMADMedian=function(e){for(var t=this.findMedian(e),n=[],i=0;i<e.length;i++)n.push(Math.abs(e[i]-t));return this.findMedian(n)}}"object"!==s(window.DotmetricsJSON)&&(window.DotmetricsJSON=window.JSON);var b=new function(){this.SettingsObject=window.DotMetricsSettings,this.boundBeacon=navigator.sendBeacon.bind(navigator),this.Core=new T(this.SettingsObject),this.EnterPageEventData=null,this.TimeOnPage=0,this.LastSentTimeOnPage=-1,this.TimeBuffer=0,this.LoadTimeStamp="",this.surveyLink="",this.DeviceId=null,this.UserId=null,this.DeviceGuidId=null,this.deviceInfoSent=!1,this.postIndex=0,this.Done=!1,this.surveyDone=!1,this.ajaxTimer=null,this.panel=!1,this.panelUserId=null,this.panelHouseholdId=null,this.videos={},this.foundVideoPlayers=[],this.timeBufferIntervalInstanceId=null,this.saveTimeOnPageIntervalFunctionId=null,this.lastInteraction=null,this.domainCookie=this.SettingsObject.DomainCookieData.value,this.domainCookieTs=this.SettingsObject.DomainCookieData.ts,this.domainCookieChanged=this.SettingsObject.DomainCookieData.changed,this.scriptVersion=this.SettingsObject.ScriptVersion,this.domainFphObject=null,this.domainFph=null,this.Start=function(){var e=this;if("https://"===String(e.Core.baseUrlPrefix).slice(0,8))try{this.domainFphObject=this.getDomainFpObjectFromStorage(),this.domainFph=null==this.domainFphObject?"":this.domainFphObject.dfph,this.urlDecorator=new S(this.Core,this.SettingsObject,this.domainCookie,this.domainCookieTs),this.urlDecorator.listenForVisitor(),document.addEventListener("visibilitychange",(function(){try{if("hidden"===document.visibilityState){e.stopIntervalFunctions(),e.emptyTimeBuffer();var t=e.SendTimeOnPageBeacon();e.SaveTimeOnPage(t)}else"visible"===document.visibilityState&&e.startIntervalFunctions()}catch(n){e.Core.sendScriptError(n)}})),e.startIntervalFunctions(),this.initPanelElements(),this.initInteractionEvents(),this.listenForExtensionMessages();var t=this.createStartData();e.Core.sendData(this.Core.baseUrlPrefix+u.DATA_URL,t),window.dm&&this.onAjaxDataUpdate(),1==this.SettingsObject.VideoTrackingEnabled&&this.trackVideos()}catch(n){e.Core.sendScriptError(n)}},this.listenForExtensionMessages=function(){var e=this;window.addEventListener("message",(function(t){t.data.source&&"dotmetrics-extension"==t.data.source&&t.data.type&&e.handleExtensionRequest(t.data.type,t.source)}))},this.handleExtensionRequest=function(e,t){switch(e){case"timeOnPage":var n=this.createCurrentTimeOnPageObject();(i=this.getTimeOnPageDataTemplate()).ep.push(n),this.Core.sendMessageToExtension({target:"dotmetrics-extension",type:"timeOnPage",data:i},t);break;case"getEnterPageData":var i;if(this.EnterPageEventData)(i=JSON.parse(JSON.stringify(this.EnterPageEventData))).ecid=this.SettingsObject.EventChainId,i.dc=this.domainCookie,i.ver=this.scriptVersion,i.dfp=this.domainFph,this.Core.postMessage({target:"dotmetrics-plugin",type:"enterPageData",data:i},t);break;case"getDeviceInfo":var r=this;this.Core.createClientInfo((function(){var e={deviceInfo:r.Core.clientInfo,deviceHash:f.SHA1(DotmetricsJSON.stringify(r.Core.clientInfo)),clientInfoTimingData:r.Core.clientInfoTimingData};r.Core.postMessage({target:"dotmetrics-extension",type:"deviceInfo",data:e},t)}));break;case"generateDiData":r=this;window.console.log("generating di data"),this.Core.runDomainFP((function(e){window.console.log("postMessage di data",e),r.Core.postMessage({target:"dotmetrics-extension",type:"diData",data:e},t)}))}},this.createStartData=function(){var e=(new Date).getTimezoneOffset(),t={id:this.SettingsObject.SiteSectionId,fl:!0,dom:window.location.hostname,lso:null,url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,tzOffset:e};this.panel&&(t.hhid=this.panelHouseholdId,t.uid=this.panelUserId);var n="DM_SitId"+this.SettingsObject.SiteId,i="DM_SitIdT"+this.SettingsObject.SiteId,r=n+"SecId"+this.SettingsObject.SiteSectionId,a=n+"SecIdT"+this.SettingsObject.SiteSectionId,o=p("DotmetricsSiteData");try{o=o?DotmetricsJSON.parse(o):{}}catch(u){o={}}var s=(new Date).getTime()-18e5;for(var c in o)o[c]<s&&delete o[c];D(n)&&o.hasOwnProperty(i)?t.oss=!1:(y(n,"1"),t.oss=!0),D(r)&&o.hasOwnProperty(a)?t.oses=!1:(y(r,"1"),t.oses=!0);var d=(new Date).getTime();return o[i]=d,o[a]=d,g({DotmetricsSiteData:JSON.stringify(o)}),t},this.processActions=function(e){try{var t=this,n=(new Date).getTimezoneOffset(),i={id:this.SettingsObject.SiteSectionId,fl:!1,dom:window.location.hostname,lso:null,ds:null,dsl:null,dh:null,url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,tzOffset:n};this.panel&&(i.hhid=this.panelHouseholdId,i.uid=this.panelUserId);var r=!1;if(e.SendDeviceInfo||e.Ping){var a={deviceInfo:!1,pings:0,exitPageData:!1};e.Ping&&e.Ping>0&&0==this.deviceInfoSent&&(a.pings=e.Ping),e.SendDeviceInfo&&0==this.deviceInfoSent&&(a.deviceInfo=!0,this.deviceInfoSent=!0),this.submitData(a)}if(e.Survey&&e.Survey.SurveyUrl)if(e.Survey,this.Survey=e.Survey,this.Survey.Mobile){var o=this;this.anchor=this.Core.CreateElement("a",{href:e.Survey.SurveyUrl,style:"position:fixed; width:100%; height:100%; top:0; left:0; background:#f00; opacity:0;z-index:99999",target:"_blank",id:"DotMetricsPopupLink"},null),document.body.appendChild(this.anchor),this.Core.addEventSimple(this.anchor,"click",(function(e){try{e.preventDefault();var t=o.anchor.getAttribute("href"),n=o.anchor.parentElement;if(n&&n.removeChild(o.anchor),o.surveyDone)return;o.surveyDone=!0,setTimeout((function(){window.open(t,"_blank")}),20)}catch(i){o.Core.sendScriptError(i)}}))}else{var s=function(){try{document.body.addEventListener?document.body.removeEventListener("click",s):document.body.detachEvent("onclick",s),t.showSurvey()}catch(e){t.Core.sendScriptError(e)}};document.body.addEventListener?document.body.addEventListener("click",s,!1):document.body.attachEvent("onclick",s)}if(e.SendDeviceHash){if(!this.Core.clientInfo)return void this.Core.createClientInfo((function(){t.processActions(e)}));var c=DotmetricsJSON.stringify(this.Core.clientInfo),l=f.SHA1(c);i.dh=l.toString(),i.dh,r=!0}if(e.PersistDeviceAndUser&&e.DeviceId&&e.UserId&&e.DeviceGuidId&&g({DotMetricsDeviceId:e.DeviceId,DotMetricsUserId:e.UserId,DotMetricsDeviceGuidId:e.DeviceGuidId}),e.SendLSO){var h=p("DotMetricsUserId"),m=p("DotMetricsDeviceId"),v=p("DotMetricsDeviceGuidId");i.lso=h&&m&&v?{d:m,u:h,dg:v}:{d:"",u:d.NULL_COOKIE_VALUE,dg:d.NULL_COOKIE_VALUE},r=!0}r&&t.Core.sendData(t.Core.baseUrlPrefix+u.DATA_URL,i)}catch(S){this.Core.sendScriptError(S)}},this._timeData=[],this._pingRawData=[],this._currentRequestNum=0,this._requestedPingsNum=0,this._onPingMeasurmentsDone=null,this._pingStartTime=0,this._pingPorcessRunning=!1,this._pingProcessQueue=[],this.measurePingTimes=function(e,t){try{if(1==this._pingPorcessRunning){var n=this;return void this._pingProcessQueue.push((function(){n.measurePingTimes(e,t)}))}this._pingPorcessRunning=!0,this._timeData=[],this._pingRawData=[],this._currentRequestNum=0,this._requestedPingsNum=e,this._onPingMeasurmentsDone=t,this.makePingRequest()}catch(i){this.Core.sendScriptError(i)}},this.makePingRequest=function(){this._pingStartTime=(new Date).getTime(),(0==this._timeData.length?{ctd:0,cl:0}:this._timeData[this._timeData.length-1]).ct=this._pingStartTime,this._pingRawData.push({ct:this._pingStartTime}),this.Core.sendData(this.Core.baseUrlPrefix+u.PING_URL,null)},this.HandlePing=function(e){try{var t=(new Date).getTime(),n=(t-this._pingStartTime)/2,i=this._pingStartTime-e.s-Math.abs(n),r={ctd:i,cl:n},a=this._pingRawData.length-1;if(this._pingRawData[a].cte=t,this._pingRawData[a].s=e.s,this._pingRawData[a].ctd=i,this._pingRawData[a].cl=n,this._timeData.push(r),this._currentRequestNum++,this._currentRequestNum<this._requestedPingsNum)this.makePingRequest();else{for(var o=0,s=0,c=[],d=[],u=0;u<this._timeData.length;u++)o+=this._timeData[u].ctd,s+=this._timeData[u].cl,c.push(this._timeData[u].ctd),d.push(this._timeData[u].cl);e={DeviceSync:o=Math.round(o/this._timeData.length),DeviceSyncLag:s=Math.round(s/this._timeData.length),DeviceSyncMedian:Math.round(this.Core.findMedian(c)),DeviceSyncLagMedian:Math.round(this.Core.findMedian(d)),DeviceSyncMAD:Math.round(this.Core.calculateMADMedian(c)),DeviceSyncLagMAD:Math.round(this.Core.calculateMADMedian(d)),raw:this._pingRawData};if(this._timeData,this._onPingMeasurmentsDone(e),this._pingPorcessRunning=!1,this._pingProcessQueue.length>0)this._pingProcessQueue.shift()()}}catch(l){this.Core.sendScriptError(l)}},this.showSurvey=function(){if(!this.surveyDone){this.surveyDone=!0;var e=this.Survey.WindowWidth,t=this.Survey.WindowHeight;window.open(this.Survey.SurveyUrl,"","width="+e+",height="+t+",scrollbars=1").focus()}},this.startIntervalFunctions=function(){var e=this;null==this.timeBufferIntervalInstanceId&&(this.timeBufferIntervalInstanceId=setInterval((function(){try{null!=document.visibilityState?"visible"==document.visibilityState&&e.TimeBuffer++:e.TimeBuffer++}catch(t){e.Core.sendScriptError(t)}}),1e3)),null==this.saveTimeOnPageIntervalFunctionId&&(this.saveTimeOnPageIntervalFunctionId=setInterval((function(){e.SaveTimeOnPage()}),d.SAVE_TIME_ON_PAGE_INTERVAL))},this.stopIntervalFunctions=function(){this.timeBufferIntervalInstanceId&&(clearInterval(this.timeBufferIntervalInstanceId),this.timeBufferIntervalInstanceId=null),this.saveTimeOnPageIntervalFunctionId&&(clearInterval(this.saveTimeOnPageIntervalFunctionId),this.saveTimeOnPageIntervalFunctionId=null)},this.emptyTimeBuffer=function(){try{(new Date).getTime()-this.lastInteraction.getTime()<=d.TIME_THRESHOLD&&(this.TimeOnPage+=this.TimeBuffer),this.TimeBuffer=0,this.lastInteraction=new Date}catch(e){this.Core.sendScriptError(e)}},this.SendTimeOnPageBeacon=function(){if(this.LastSentTimeOnPage==this.TimeOnPage)return!0;if(navigator.sendBeacon&&this.EnterPageEventData){var e=this.createCurrentTimeOnPageObject(),t=this.getTimeOnPageDataTemplate();return t.ep.push(e),this.LastSentTimeOnPage=this.TimeOnPage,this.Core.performSendBeacon(this.Core.baseUrlPrefix+u.BEACON_URL,t)}return!1},this.createCurrentTimeOnPageObject=function(){return{cd:this.EnterPageEventData.CreationDate,eid:this.EnterPageEventData.EventId,id:this.EnterPageEventData.SiteSectionId,sop:this.TimeOnPage,vl:this.getVideoData(),url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph}},this.getTimeOnPageDataTemplate=function(){var e=(new Date).getTimezoneOffset(),t={id:this.SettingsObject.SiteSectionId,cd:{d:this.DeviceId,u:this.UserId,dg:this.DeviceGuidId},ep:[],tzOffset:e};return this.panel&&(t.hhid=this.panelHouseholdId,t.uid=this.panelUserId),t},this.SaveTimeOnPage=function(e){try{if(0==v())return;if(null==this.EnterPageEventData)return;for(var t=this.getTimeOnPageData(),n=0;n<t.length;n++)if(t[n].eid==this.EnterPageEventData.EventId){t.splice(n,1);break}if(!e){var i=this.createCurrentTimeOnPageObject();t.push(i)}t.length>d.MAX_TIME_ON_PAGE_ITEMS_IN_LOCAL_STORAGE&&t.splice(0,t.length-d.MAX_TIME_ON_PAGE_ITEMS_IN_LOCAL_STORAGE);var r={};r[this.SettingsObject.TimeOnPage]=DotmetricsJSON.stringify(t),g(r)}catch(a){this.Core.sendScriptError(a)}},this.processTimeOnPageData=function(){try{if(0==v())return null;for(var e=[],t=this.getTimeOnPageData(),n=new Date,i=0;i<t.length;i++)try{var r=t[i],a=new Date(r.cd);n.getTime()-a.getTime()<864e5&&e.push(r)}catch(s){}return 0==e.length&&(e=null),o=this.SettingsObject.TimeOnPage,v()&&window.localStorage.removeItem(o+""),e}catch(s){this.Core.sendScriptError(s)}var o},this.getTimeOnPageData=function(){try{var e=p(this.SettingsObject.TimeOnPage),t=[];if(null!=e&&e.length>0)try{t=DotmetricsJSON.parse(e)}catch(n){t=JSON.parse(e)}return t}catch(n){return this.Core.sendScriptError(n),[]}},this.initInteractionEvents=function(){this.lastInteraction=new Date;var e=this;this.Core.addEventSimple(document,"mousemove",(function(){e.emptyTimeBuffer()})),this.Core.addEventSimple(document,"wheel",(function(){e.emptyTimeBuffer()})),this.Core.addEventSimple(document,"touchend",(function(){e.emptyTimeBuffer()}))},this.initPanelElements=function(){if(document.getElementById("DotmetricsPanelUserId")&&document.getElementById("DotmetricsPanelHouseholdId")){this.panel=!0,this.panelUserId=document.getElementById("DotmetricsPanelUserId").value,this.panelHouseholdId=document.getElementById("DotmetricsPanelHouseholdId").value;var e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("id","DotmetricsScriptLoaded"),e.setAttribute("value","true"),document.getElementsByTagName("head")[0].appendChild(e)}},this.CreateIframe=function(){this.iFrameHolderDiv=this.Core.CreateElement("div",{id:"DotMetricsPF",style:"display:none;width:0px;height:0px;position:absolute; left:-2000px;"},null);var e="dotmetricsframe"+this.postIndex;this.postIndex++,this.iFrameHolderDiv.style.display="none";try{this.iframe=document.createElement('<iframe name="'+e+'" style:"display:none;width:0px;height:0px;">')}catch(t){this.iframe=this.Core.CreateElement("iframe",{name:e,id:e,style:"display:none;width:0px;height:0px;"},null)}this.iframe.id=e,this.form=this.Core.CreateElement("form",{action:this.Core.baseUrlPrefix+u.POST_URL,method:"post",target:e,id:"DotMetricsForm"},null),this.formInput=this.Core.CreateElement("input",{type:"text",name:"v"},null),document.body.appendChild(this.iFrameHolderDiv),this.iFrameHolderDiv.appendChild(this.iframe),this.iFrameHolderDiv.appendChild(this.form),this.form.appendChild(this.formInput),document.getElementById("DotMetricsForm").target=e},this.submitData=function(e){var t=this;if(this.Core.formPostCount++,!(this.Core.formPostCount>d.CALL_LIMIT)){var n=(new Date).getTimezoneOffset(),i={id:this.SettingsObject.SiteSectionId,cd:{d:this.DeviceId,u:this.UserId,dg:this.DeviceGuidId},di:null,ds:0,dsl:0,url:window.location.href,rurl:window.document.referrer,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,tzOffset:n};if(this.panel&&(i.hhid=this.panelHouseholdId,i.uid=this.panelUserId),e.deviceInfo){if(!this.Core.clientInfo)return void this.Core.createClientInfo((function(){t.submitData(e)}));i.di=this.Core.clientInfo}e.pings>0?this.measurePingTimes(e.pings,(function(e){i.ds=e.DeviceSync,i.dsl=e.DeviceSyncLag,r()})):r()}function r(){try{t.CreateIframe(),t.formInput.value=DotmetricsJSON.stringify(i),t.form.submit();var e=t.iFrameHolderDiv;setTimeout((function(){document.body.removeChild(e)}),5e3)}catch(n){t.Core.sendScriptError(n)}}},this.HandleJsonp=function(e){try{var t=this;if(t.Core.sendMessageToExtension({target:"dotmetrics-extension",type:"jsonpResponse",data:e,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph}),this.UserId=e.UserId,this.DeviceId=e.DeviceId,this.DeviceGuidId=e.DeviceGuidId,window.DotMetricsObj.DeviceId=this.DeviceId,window.DotMetricsObj.UserId=this.UserId,this.deviceInfoSent&&(e.SendDeviceInfo=!1,e.Ping=0),this.firstLoadDone)this.processActions(e);else{this.firstLoadDone=!0,this.EnterPageEventData=e.EnterPageEventData,window.DotMetricsObj.firstLoadDone=!0,window.DotMetricsObj.EnterPageEventData=e.EnterPageEventData,this.runDomainFPProcess();var n={deviceInfo:!1,pings:0};1==e.SendDeviceInfo&&0==this.deviceInfoSent&&(n.deviceInfo=!0,e.SendDeviceInfo=!1,this.deviceInfoSent=!0),e.Ping&&e.Ping>0&&(n.pings=e.Ping,e.Ping=!1),setTimeout((function(){try{(n.deviceInfo||n.pings)&&t.submitData(n);var i=t.processTimeOnPageData();if(y(t.SettingsObject.TimeOnPage,null,0),i){var r=t.getTimeOnPageDataTemplate();r.ep=i,t.Core.performAjaxPost(t.Core.baseUrlPrefix+u.BEACON_URL,r)}t.processActions(e)}catch(a){t.Core.sendScriptError(a)}}),1e3*Math.random()+500)}}catch(i){this.Core.sendScriptError(i)}},this.getDomainFpObjectFromStorage=function(){var e,t;try{e=JSON.parse(p(d.DOMAIN_FPH_KEY))}catch(n){e=null}try{t=JSON.parse(w(d.DOMAIN_FPH_KEY))}catch(n){t=null}return this.syncDomainFpObject(e,t)},this.syncDomainFpObject=function(e,t){var n=this.checkIfDomainFpValid(e),i=this.checkIfDomainFpValid(t),r=null;if(n&&i?r=e.time>t.time?e:t:n?r=e:i&&(r=t),null!=r){var a=JSON.stringify(r),o={};o[d.DOMAIN_FPH_KEY]=a,g(o),y(d.DOMAIN_FPH_KEY,a,365)}return r},this.checkIfDomainFpValid=function(e){return!!(void 0!==e&&null!=e&&null!=e.dfph&&""!=e.dfph&&(40==e.dfph.length||e.dfph.indexOf("_unstable")>0)&&e.v&&e.time&&e.niTime)},this.runDomainFPProcess=function(){var e=!1;if(!(0==this.SettingsObject.DomainCookieEnabled||(new Date).getTime()-this.domainCookieTs<d.TIME_STAMP_LIMIT_24_HOURS)){var t=this.domainFphObject,n=t&&t.dfph?t.dfph:null,i=t&&t.time?t.time:0;if(e=!(!t||10===t.v)||(new Date).getTime()-i>d.TIME_STAMP_LIMIT_5_DAYS,0!=(1==this.domainCookieChanged||1==e||null==n)){var r=this;this.Core.runDomainFP((function(e){try{var t={dfph:e.dfph,time:(new Date).getTime(),niTime:(new Date).getTime(),v:10},n={id:r.SettingsObject.SiteSectionId,ecid:r.SettingsObject.EventChainId,eid:r.EnterPageEventData.EventId,dc:r.domainCookie,ver:r.scriptVersion,dfph:e.dfph};r.runNetworkMeasurements((function(i){n.ts=i.ts,n.ni=i.ni,r.Core.performFPPost(r.Core.baseUrlPrefix+u.EDI_URL,n,(function(i){try{"OK"==i?r.syncDomainFpObject(t):(n.dfp=e.dfp,n.td=e.timingData,r.Core.performFPPost(r.Core.baseUrlPrefix+u.EDI_URL,n,(function(e){"OK"==e&&r.syncDomainFpObject(t)})))}catch(a){r.Core.sendScriptError(a)}}))}))}catch(i){r.Core.sendScriptError(i)}}))}else this.runDailyEdi(t)}},this.runDailyEdi=function(e){if(this.checkIfDomainFpValid(e)&&e.time&&e.niTime){var t=new Date,n=new Date(e.time),i=new Date(e.niTime);if(t.getDate()==n.getDate()||t.getDate()==i.getDate())return;var r=this;this.runNetworkMeasurements((function(t){if(!(t.ts.dlm>1e3)){var n={id:r.SettingsObject.SiteSectionId,ecid:r.SettingsObject.EventChainId,eid:r.EnterPageEventData.EventId,dc:r.domainCookie,ver:r.scriptVersion,dfph:e.dfph,ts:t.ts,ni:t.ni};r.Core.performFPPost(r.Core.baseUrlPrefix+u.EDI_DAILY_URL,n),e.niTime=(new Date).getTime(),r.syncDomainFpObject(e)}}))}},this.runNetworkMeasurements=function(e){var t=this;this.measurePingTimes(5,(function(n){var i={};i.ts={dsa:n.DeviceSync,dsm:n.DeviceSyncMedian,dsmad:n.DeviceSyncMAD,dla:n.DeviceSyncLag,dlm:n.DeviceSyncLagMedian,dlmad:n.DeviceSyncLagMAD,raw:n.raw},i.ni=t.Core.getNetworkInformation(),e(i)}))},this.onAjaxDataUpdate=function(){try{var e=window.dm,t=this;if("https://"!==String(t.Core.baseUrlPrefix).slice(0,8))return;null==this.ajaxTimer&&void 0!==e&&void 0!==e.AjaxData&&e.AjaxData.length>0&&(this.ajaxTimer=setTimeout((function(){try{t.cloneAjaxDataForStressTestScript(e.AjaxData);var n=t.prepareAjaxData(e.AjaxData);e.AjaxData.length=0,t.ajaxTimer=null,t.Core.performAjaxPost(t.Core.baseUrlPrefix+u.AJAX_EVENT_URL,n)}catch(i){t.Core.sendScriptError(i)}}),this.SettingsObject.AjaxEventTimeout))}catch(n){this.Core.sendScriptError(n)}},this.cloneAjaxDataForStressTestScript=function(e){try{var t="dmStress";if(void 0!==window.DotMetricsObjStress){var n=JSON.parse(JSON.stringify(e));void 0===window[t]&&(window[t]={AjaxData:[]});for(var i=0;i<n.length;i++)window[t].AjaxData.push(n[i]);window.DotMetricsObjStress.onAjaxDataUpdate()}}catch(r){}},this.prepareAjaxData=function(e){var t=(new Date).getTimezoneOffset(),n={siteSectionId:this.SettingsObject.SiteSectionId,ecid:this.SettingsObject.EventChainId,dc:this.domainCookie,ver:this.scriptVersion,dfph:this.domainFph,domain:window.location.hostname,events:[],tzOffset:t};this.panel&&(n.hhid=this.panelHouseholdId,n.uid=this.panelUserId);var i=this;return e.forEach((function(e){var t={};e.et?t.eventType=e.et:t.eventType="pageview",e.d?t.eventData=e.d:t.eventData=null,e.ssid?t.eventSiteSectionId=e.ssid:t.eventSiteSectionId=i.SettingsObject.SiteSectionId,isNaN(t.eventSiteSectionId)&&(t.eventTag=t.eventSiteSectionId,delete t.eventSiteSectionId),e.url?t.url=e.url:t.url=window.location.href,n.events.push(t)})),n},this.trackVideos=function(){var e=this;new m((function(t,n,i){switch(t){case"flowPlayer":e.trackFP(i,t,n);break;case"jwPlayer":e.trackJW(i,t,n);break;case"videojs":e.trackVideoJS(i,t,n)}})).init()};var e=!1;this.sendVideoError=function(t,n,i){if(!e){e=!0;var r={};i&&i.name&&(r.name=i.name),i&&i.message&&(r.message=i.message),i&&i.stack&&(r.stack=i.stack);var a={type:"video",details:{player:t,playerVersion:n},error:r,sectionId:this.SettingsObject.SiteSectionId,pageUrl:window.location.href};this.Core.performAjaxPost(this.Core.baseUrlPrefix+u.ERROR_EVENT_URL,a)}},this.trackFP=function(e,t,n){var i=this,r=null,a=null;function o(){var t="";try{t=e.opts.title}catch(i){}var n=e.currentSrc;return"".concat(n,"_").concat(t)}function s(){var t="";try{t=e.opts.title}catch(c){}var n=Math.max(0,e.duration),s=o();i.videos[s]={vid:e.currentSrc,w:e.videoWidth,h:e.videoHeight,vdur:n,tw:0,ls:e.opts.live,t:t},r=null,a=null}var c=function(e){try{s()}catch(t){l(t)}},d=function(t){try{r=e.currentTime,a=(new Date).getTime()}catch(n){l(n)}},u=function(t){try{if(r&&0==e.playerState["is-seeking"]){var n=e.currentTime-r,c=.001*((new Date).getTime()-a);if(n>0){if(n>1)return;var d=o();i.videos[d]?(e.currentTime!=r&&c>0&&c<1&&(i.videos[d].tw+=c),i.videos[d].vdur<e.duration&&(i.videos[d].vdur=e.duration)):s()}}r=e.currentTime,a=(new Date).getTime()}catch(u){l(u)}};function l(r){e.off("loadedmetadata",c),e.off("seeked",d),e.off("timeupdate",u),i.sendVideoError(t,n,r)}e.on("loadedmetadata",c),e.on("seeked",d),e.on("timeupdate",u)},this.trackJW=function(e,t,n){var i=this,r=null,a=null;function o(e){return"".concat(e.file,"_").concat(e.title)}function s(){var t=e.getPlaylistItem();if(void 0!==t){var n=o(t);if(!i.videos[n]){var s=e.getConfig?e.getConfig():void 0;i.videos[n]={vid:t.file,w:e.getWidth(),h:e.getHeight(),vdur:e.getDuration(),tw:0,ls:!!s&&(s&&"Live"==s.streamType),t:t.title},i.videos[n].vdur<0&&(i.videos[n].vdur=0)}r=e.getPosition(),a=(new Date).getTime()}}var c=function(e){try{s()}catch(t){l(t)}},d=function(e){try{r=e.offset}catch(t){l(t)}},u=function(t){try{if(r){var n=.001*((new Date).getTime()-a),c=e.getPlaylistItem();if(void 0===c)return;var d=o(c);void 0===i.videos[d]&&s(),t.position!=r&&n>0&&n<1&&(i.videos[d].tw+=n),i.videos[d].h||(i.videos[d].h=e.getHeight()),i.videos[d].w||(i.videos[d].w=e.getWidth()),(!i.videos[d].vdur||i.videos[d].vdur<e.getDuration())&&(i.videos[d].vdur=e.getDuration())}r=t.position,a=(new Date).getTime()}catch(u){l(u)}};function l(r){e.off&&(e.off("play",c),e.off("seek",d),e.off("time",u)),i.sendVideoError(t,n,r)}e.on?(e.on("play",c),e.on("seek",d),e.on("time",u)):(e.onPlay(c),e.onSeek(d),e.onTime(u))},this.trackVideoJS=function(e,t,n){var i=this,r=null,a=null;function o(){var t=e.mediainfo?e.mediainfo.name:"",n=e.currentSrc();return"".concat(n,"_").concat(t)}function s(){var t=e.currentSrc();if(""!=t){var n=o();i.videos[n]||(i.videos[n]={vid:t,w:"function"==typeof e.videoWidth?e.videoWidth():e.width(),h:"function"==typeof e.videoHeight?e.videoHeight():e.height(),vdur:e.duration(),tw:0,ls:!1,t:e.mediainfo?e.mediainfo.name:""},i.videos[n].vdur<0&&(i.videos[n].vdur=0),r=null,a=null)}}var c=function(){try{s()}catch(e){u(e)}},d=function(){try{if(r&&0==e.seeking()&&("function"!=typeof e.scrubbing||0==e.scrubbing())){var t=.001*((new Date).getTime()-a);if(""==e.currentSrc())return;var n=o();if(void 0===i.videos[n])return void s();try{i.videos[n].ls=i.videos[n].ls||"undefined"!=e.liveTracker&&e.liveTracker.isLive&&e.liveTracker.isLive()}catch(d){}var c=!1;try{c="adPlaying"==e.playerState.getStateName()}catch(d){}i.videos[n].vdur<e.duration()&&(i.videos[n].vdur=e.duration()),0==c&&e.currentTime()!=r&&t>0&&t<1&&(i.videos[n].tw+=t)}r=e.currentTime(),a=(new Date).getTime()}catch(d){u(d)}};function u(r){e.off("loadedmetadata",c),e.off("timeupdate",d),i.sendVideoError(t,n,r)}e.on("loadedmetadata",c),e.on("timeupdate",d)},this.getVideoData=function(){var e=this.videos,t=[];for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(!i.vid||""==i.vid||i.vid.indexOf("data:video")>=0)continue;i.w=Math.round(i.w),i.h=Math.round(i.h),i.w||(i.w=0),i.h||(i.h=0),i.vdur&&isFinite(i.vdur)?(i.vdur=Math.round(i.vdur),i.vdur<0&&(i.vdur=0)):i.vdur=0,i.tw>0&&i.tw<1&&(i.tw=1),i.tw=Math.round(i.tw),i.tw>0&&t.push(i)}return t}};window.DotMetricsObj={onAjaxDataUpdate:function(){b.onAjaxDataUpdate()},HandleJsonp:function(e){b.HandleJsonp(e)},HandlePing:function(e){b.HandlePing(e)}},top.location==self.location&&setTimeout((function(){b.Start()}),100)}();
